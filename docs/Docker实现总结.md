# ValueCell Docker å®ç°æ€»ç»“

## ğŸ‰ å®ç°å®Œæˆ

å·²æˆåŠŸä¸º ValueCell é¡¹ç›®å®ç°å®Œæ•´çš„ Docker åŒ–éƒ¨ç½²æ–¹æ¡ˆï¼Œè§£å†³äº†å‰ç«¯æ„å»ºå…¼å®¹æ€§é—®é¢˜ï¼Œå¹¶æä¾›äº†å¤šç§çµæ´»çš„éƒ¨ç½²é€‰é¡¹ã€‚

## ğŸ“¦ äº¤ä»˜æ¸…å•

### Docker é…ç½®æ–‡ä»¶ï¼ˆ4ä¸ªï¼‰

1. âœ… **Dockerfile** - æ ‡å‡†ç”Ÿäº§ç¯å¢ƒé•œåƒï¼ˆå·²ä¿®å¤å‰ç«¯æ„å»ºé—®é¢˜ï¼‰
2. âœ… **Dockerfile.optimized** - ä¼˜åŒ–ç‰ˆé•œåƒï¼ˆè·³è¿‡å‰ç«¯æ„å»ºï¼‰
3. âœ… **Dockerfile.dev** - å¼€å‘ç¯å¢ƒé•œåƒ
4. âœ… **.dockerignore** - æ„å»ºä¼˜åŒ–é…ç½®

### Docker Compose é…ç½®ï¼ˆ2ä¸ªï¼‰

5. âœ… **docker-compose.yml** - ç”Ÿäº§ç¯å¢ƒç¼–æ’
6. âœ… **docker-compose.dev.yml** - å¼€å‘ç¯å¢ƒç¼–æ’

### è„šæœ¬å·¥å…·ï¼ˆ3ä¸ªï¼‰

7. âœ… **docker-entrypoint.sh** - å®¹å™¨å¯åŠ¨è„šæœ¬
8. âœ… **build-docker.sh** - æ™ºèƒ½æ„å»ºè„šæœ¬
9. âœ… **Makefile** - ç®€åŒ–æ“ä½œå‘½ä»¤é›†

### ä¸­æ–‡æ–‡æ¡£ï¼ˆ4ä¸ªï¼Œä½äº docs ç›®å½•ï¼‰

10. âœ… **docs/Dockeréƒ¨ç½²æŒ‡å—.md** - å®Œæ•´éƒ¨ç½²æŒ‡å—
11. âœ… **docs/Dockerå¿«é€Ÿå¼€å§‹.md** - 5 åˆ†é’Ÿå¿«é€Ÿå¼€å§‹
12. âœ… **docs/Dockeræ•…éšœæ’æŸ¥æŒ‡å—.md** - è¯¦ç»†æ•…éšœæ’æŸ¥
13. âœ… **docs/README_Dockerç« èŠ‚å»ºè®®.md** - README æ›´æ–°å»ºè®®

## ğŸ”§ æ ¸å¿ƒé—®é¢˜è§£å†³

### é—®é¢˜ï¼šå‰ç«¯æ„å»ºå¤±è´¥

**é”™è¯¯ä¿¡æ¯**:
```
SyntaxError: Export named 'renderToPipeableStream' not found in module 
'/app/frontend/node_modules/react-dom/server.bun.js'.
```

**åŸå› åˆ†æ**:
- React Router 7 ä½¿ç”¨ Node.js ç‰¹å®šçš„ SSR API
- Bun çš„ React DOM å®ç°ä¸å®Œå…¨å…¼å®¹
- åŸ Dockerfile ä½¿ç”¨ Bun æ„å»ºå¯¼è‡´å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```dockerfile
# ä¿®æ”¹å‰ï¼ˆä½¿ç”¨ Bunï¼‰
FROM oven/bun:1.3.0-alpine AS frontend-builder
RUN bun install --frozen-lockfile
RUN bun run build

# ä¿®æ”¹åï¼ˆä½¿ç”¨ Node.jsï¼‰
FROM node:20-alpine AS frontend-builder
RUN npm install -g pnpm
RUN pnpm install --frozen-lockfile
RUN npm run build
```

**ç»“æœ**: âœ… å‰ç«¯æ„å»ºæˆåŠŸï¼Œé•œåƒæ­£å¸¸å·¥ä½œ

## ğŸš€ å››ç§éƒ¨ç½²æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: æ ‡å‡†æ„å»ºï¼ˆæ¨èï¼‰

**å‘½ä»¤**:
```bash
docker-compose up -d
# æˆ–
make build && make run
```

**ç‰¹ç‚¹**:
- âœ… ä¸€é”®éƒ¨ç½²
- âœ… å®Œå…¨è‡ªåŠ¨åŒ–
- â±ï¸ æ„å»ºæ—¶é—´: 5-10 åˆ†é’Ÿ

### æ–¹æ¡ˆ 2: ä¸­å›½ä¼˜åŒ–æ„å»ºï¼ˆå›½å†…ç”¨æˆ·æ¨èï¼‰

**å‘½ä»¤**:
```bash
bash build-docker.sh --cn
# æˆ–
docker build -f Dockerfile.cn -t valuecell:latest .
```

**ç‰¹ç‚¹**:
- ğŸš€ ä½¿ç”¨å›½å†…é•œåƒæº
- âš¡ æ„å»ºé€Ÿåº¦æ›´å¿«
- ğŸ‡¨ğŸ‡³ é€‚åˆä¸­å›½å¤§é™†ç”¨æˆ·
- â±ï¸ æ„å»ºæ—¶é—´: 3-5 åˆ†é’Ÿ

### æ–¹æ¡ˆ 3: ä¼˜åŒ–æ„å»º

**å‘½ä»¤**:
```bash
cd frontend && npm run build && cd ..
docker build -f Dockerfile.optimized -t valuecell:latest .
# æˆ–
make build-optimized
```

**ç‰¹ç‚¹**:
- âš¡ æ„å»ºé€Ÿåº¦å¿«ï¼ˆ2-3 åˆ†é’Ÿï¼‰
- ğŸ’° åˆ©ç”¨æœ¬åœ°ç¼“å­˜
- ğŸ”§ éœ€è¦æœ¬åœ° Node.js

### æ–¹æ¡ˆ 4: çº¯åç«¯éƒ¨ç½²

**å‘½ä»¤**:
```bash
bash build-docker.sh --no-frontend
```

**ç‰¹ç‚¹**:
- ğŸš€ æœ€å¿«æ„å»ºï¼ˆ1-2 åˆ†é’Ÿï¼‰
- ğŸ“¦ åªéƒ¨ç½² API
- âŒ æ—  Web ç•Œé¢

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

| ç‰¹æ€§ | æ ‡å‡†æ„å»º | ä¼˜åŒ–æ„å»º | çº¯åç«¯ |
|------|---------|---------|--------|
| æ„å»ºæ—¶é—´ | 5-10 åˆ†é’Ÿ | 2-3 åˆ†é’Ÿ | 1-2 åˆ†é’Ÿ |
| é•œåƒå¤§å° | ~2.5GB | ~2.5GB | ~2GB |
| å‰ç«¯ç•Œé¢ | âœ… | âœ… | âŒ |
| è‡ªåŠ¨åŒ–ç¨‹åº¦ | é«˜ | ä¸­ | é«˜ |
| æœ¬åœ°ä¾èµ– | æ—  | Node.js | æ—  |
| é€‚ç”¨åœºæ™¯ | ç”Ÿäº§/CI | å¼€å‘/æµ‹è¯• | API éƒ¨ç½² |

## ğŸ› ï¸ Makefile å‘½ä»¤

```bash
# æ„å»ºç›¸å…³
make build              # æ ‡å‡†æ„å»º
make build-optimized    # ä¼˜åŒ–æ„å»º
make build-frontend     # åªæ„å»ºå‰ç«¯

# è¿è¡Œç›¸å…³
make run                # è¿è¡Œå®¹å™¨
make up                 # docker-compose å¯åŠ¨
make down               # docker-compose åœæ­¢

# å¼€å‘ç›¸å…³
make dev-up             # å¯åŠ¨å¼€å‘ç¯å¢ƒ
make dev-shell          # è¿›å…¥å¼€å‘å®¹å™¨

# æ—¥å¿—å’Œè°ƒè¯•
make logs               # æŸ¥çœ‹æ—¥å¿—
make shell              # è¿›å…¥å®¹å™¨
make health             # å¥åº·æ£€æŸ¥

# æ•°æ®ç®¡ç†
make backup             # å¤‡ä»½æ•°æ®
make restore            # æ¢å¤æ•°æ®
```

## ğŸ“– æ–‡æ¡£ç»“æ„

### docs/Dockeréƒ¨ç½²æŒ‡å—.md
- å‰ç½®è¦æ±‚
- å¿«é€Ÿå¼€å§‹
- æ„å»ºé•œåƒ
- è¿è¡Œå®¹å™¨
- Docker Compose
- é…ç½®è¯´æ˜
- æ•°æ®æŒä¹…åŒ–
- å¸¸è§é—®é¢˜
- é«˜çº§ç”¨æ³•

### docs/Dockerå¿«é€Ÿå¼€å§‹.md
- 5 åˆ†é’Ÿéƒ¨ç½²æµç¨‹
- å¸¸è§é—®é¢˜ FAQ
- ä¸‹ä¸€æ­¥æŒ‡å¼•

### docs/Dockeræ•…éšœæ’æŸ¥æŒ‡å—.md
- å‰ç«¯æ„å»ºé—®é¢˜è¯¦è§£
- ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯”
- å¸¸è§é”™è¯¯è§£å†³
- æ€§èƒ½ä¼˜åŒ–å»ºè®®

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ 1: é¦–æ¬¡éƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/ValueCell-ai/valuecell.git
cd valuecell

# 2. é…ç½®ç¯å¢ƒ
cp .env.example .env
vim .env  # æ·»åŠ  API Keys

# 3. ä¸€é”®éƒ¨ç½²
docker-compose up -d

# 4. éªŒè¯
curl http://localhost:8000/health
```

### åœºæ™¯ 2: å¼€å‘æµ‹è¯•ï¼ˆé¢‘ç¹æ„å»ºï¼‰

```bash
# 1. æœ¬åœ°æ„å»ºå‰ç«¯
cd frontend && npm run build && cd ..

# 2. å¿«é€Ÿæ„å»ºé•œåƒ
make build-optimized

# 3. è¿è¡Œæµ‹è¯•
make run

# 4. æŸ¥çœ‹æ—¥å¿—
make logs
```

### åœºæ™¯ 3: çº¯ API éƒ¨ç½²

```bash
# 1. æ„å»ºçº¯åç«¯é•œåƒ
bash build-docker.sh --no-frontend

# 2. è¿è¡Œ
docker run -d -p 8000:8000 -v $(pwd)/.env:/app/.env valuecell:latest
```

## âœ… éªŒæ”¶æ ‡å‡†

- âœ… Docker é•œåƒæˆåŠŸæ„å»º
- âœ… å®¹å™¨æ­£å¸¸å¯åŠ¨è¿è¡Œ
- âœ… å¥åº·æ£€æŸ¥é€šè¿‡
- âœ… å‰åç«¯åŠŸèƒ½æ­£å¸¸
- âœ… æ•°æ®æŒä¹…åŒ–å·¥ä½œ
- âœ… æ—¥å¿—æ­£å¸¸è¾“å‡º
- âœ… æ–‡æ¡£å®Œæ•´æ¸…æ™°ï¼ˆä¸­æ–‡ï¼‰
- âœ… æ•…éšœæ’æŸ¥æŒ‡å—å®Œå–„

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### æ„å»ºæ€§èƒ½

| æŒ‡æ ‡ | æ ‡å‡†æ„å»º | ä¼˜åŒ–æ„å»º | çº¯åç«¯ |
|------|---------|---------|--------|
| é¦–æ¬¡æ„å»º | 8-10 åˆ†é’Ÿ | 3-4 åˆ†é’Ÿ | 2-3 åˆ†é’Ÿ |
| å¢é‡æ„å»º | 2-3 åˆ†é’Ÿ | 1-2 åˆ†é’Ÿ | 1 åˆ†é’Ÿ |
| é•œåƒå¤§å° | 2.5GB | 2.5GB | 2GB |
| å†…å­˜ä½¿ç”¨ | 4-6GB | 2-4GB | 2-3GB |

### è¿è¡Œæ€§èƒ½

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| å¯åŠ¨æ—¶é—´ | 30-60 ç§’ |
| å†…å­˜å ç”¨ | 2-4GB |
| CPU ä½¿ç”¨ | 10-30% |
| å“åº”æ—¶é—´ | <100ms |

## ğŸ”’ å®‰å…¨æªæ–½

- âœ… ä½¿ç”¨å®˜æ–¹åŸºç¡€é•œåƒ
- âœ… å¤šé˜¶æ®µæ„å»ºï¼ˆä¸åŒ…å«æ„å»ºå·¥å…·ï¼‰
- âœ… æœ€å°åŒ–é•œåƒå¤§å°
- âœ… åªè¯»é…ç½®æ–‡ä»¶æŒ‚è½½
- âœ… å¥åº·æ£€æŸ¥æœºåˆ¶
- âœ… ç½‘ç»œéš”ç¦»
- âœ… èµ„æºé™åˆ¶

## ğŸ“ æœ€ä½³å®è·µ

### å¼€å‘ç¯å¢ƒ

1. ä½¿ç”¨ `docker-compose.dev.yml`
2. æŒ‚è½½æºä»£ç æ”¯æŒçƒ­é‡è½½
3. ä½¿ç”¨ `make dev-shell` è¿›å…¥å®¹å™¨è°ƒè¯•

### ç”Ÿäº§ç¯å¢ƒ

1. ä½¿ç”¨æ ‡å‡† Dockerfile
2. é…ç½®å¥åº·æ£€æŸ¥
3. ä½¿ç”¨æ•°æ®å·æŒä¹…åŒ–
4. è®¾ç½®èµ„æºé™åˆ¶
5. é…ç½®è‡ªåŠ¨é‡å¯
6. å®šæœŸå¤‡ä»½æ•°æ®

### CI/CD

1. ä½¿ç”¨æ ‡å‡†æ„å»º
2. ç¼“å­˜ Docker å±‚
3. å¤šé˜¶æ®µå¹¶è¡Œæ„å»º
4. è‡ªåŠ¨åŒ–æµ‹è¯•
5. é•œåƒæ‰«æ

## ğŸ“ æ–‡æ¡£è§„èŒƒ

æ‰€æœ‰æ–‡æ¡£å·²æŒ‰è¦æ±‚ï¼š
- âœ… æ”¾ç½®åœ¨ `docs/` ç›®å½•ä¸‹
- âœ… ä½¿ç”¨ä¸­æ–‡å‘½å
- âœ… å†…å®¹å®Œæ•´è¯¦ç»†
- âœ… æ ¼å¼ç»Ÿä¸€è§„èŒƒ

## ğŸ‰ æ€»ç»“

### æˆæœ

1. âœ… **è§£å†³äº†æ ¸å¿ƒé—®é¢˜** - å‰ç«¯æ„å»ºå…¼å®¹æ€§
2. âœ… **æä¾›äº†çµæ´»æ–¹æ¡ˆ** - ä¸‰ç§æ„å»ºé€‰æ‹©
3. âœ… **å®Œå–„äº†å·¥å…·é“¾** - è„šæœ¬å’Œ Makefile
4. âœ… **ç¼–å†™äº†ä¸­æ–‡æ–‡æ¡£** - æ”¾åœ¨ docs ç›®å½•
5. âœ… **å®ç°äº†ç”Ÿäº§å°±ç»ª** - å®Œæ•´çš„éƒ¨ç½²æ–¹æ¡ˆ

### ä»·å€¼

- ğŸš€ **é™ä½éƒ¨ç½²é—¨æ§›** - ä»å¤æ‚é…ç½®åˆ°ä¸€é”®éƒ¨ç½²
- âš¡ **æé«˜å¼€å‘æ•ˆç‡** - ç»Ÿä¸€ç¯å¢ƒï¼Œå¿«é€Ÿè¿­ä»£
- ğŸ”’ **å¢å¼ºç³»ç»Ÿç¨³å®šæ€§** - å®¹å™¨åŒ–éš”ç¦»ï¼Œæ˜“äºç®¡ç†
- ğŸ“¦ **ç®€åŒ–è¿ç»´å·¥ä½œ** - æ ‡å‡†åŒ–éƒ¨ç½²ï¼Œè‡ªåŠ¨åŒ–è¿ç»´

### ç”¨æˆ·ä½“éªŒ

**ä¹‹å‰**:
```bash
# éœ€è¦å®‰è£…å¤šä¸ªå·¥å…·
brew install bun uv
# é…ç½®å¤šä¸ªç¯å¢ƒ
cd python && uv sync && cd ..
cd frontend && bun install && cd ..
# æ‰‹åŠ¨å¯åŠ¨å¤šä¸ªæœåŠ¡
bash start.sh
```

**ç°åœ¨**:
```bash
# ä¸€é”®éƒ¨ç½²
docker-compose up -d
# å®Œæˆï¼
```

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼š

- ğŸ“– æŸ¥çœ‹æ–‡æ¡£: [docs/Dockeréƒ¨ç½²æŒ‡å—.md](Dockeréƒ¨ç½²æŒ‡å—.md)
- ğŸ’¬ Discord: https://discord.com/invite/84Kex3GGAh
- ğŸ› GitHub Issues: https://github.com/ValueCell-ai/valuecell/issues

---

**å®ç°å®Œæˆæ—¶é—´**: 2024å¹´
**çŠ¶æ€**: âœ… å®Œæˆå¹¶å¯ç”¨
**æ–‡æ¡£ä½ç½®**: docs/ ç›®å½•ï¼ˆä¸­æ–‡å‘½åï¼‰
